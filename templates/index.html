<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8" />
    <title>{% block title %}yunjing{% endblock %}</title>

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}" />
</head>

<body>
    <!-- header -->
    <header>
        <a href="{{ url_for('index')}}">主页</a>
        <a href="{{ url_for('add1') }}">选项1</a>
        <a href="{{ url_for('add2') }}">选项2</a>
        <a href="{{ url_for('add3') }}">选项3</a>
    </header>
    <!-- end header -->

    <!-- main -->
    <main>
        {% block main %}

        <form method="post" action="{{ url_for('index') }}" name="name">
            <input type="text" name="content" placeholder="请输入搜索内容" />
            <input type="submit" value="搜索" />
        </form>

        <!-- 输入空值 -->
        {% if keyword == "" %}
        <div>
            <p class="error-message">请重新输入</p>
        </div>

        <!-- 未查询到 -->
        {% elif poems == [] %}
        <div>
            <p class="error-message">未查询到相关内容</p>
        </div>

        <!-- 查询到并高亮展示关键词 -->
        {% else %}
        <div>
            <table>
                <tr>
                    <th>朝代</th>
                    <th>原文</th>
                    <th>出处</th>
                    <th>分类</th>
                </tr>
                {% for poem in poems %}
                <tr>
                    <td>{{ poem.dynasty }}</td>
                    <td>
                        {% set text = poem.ori.replace(keyword, '<span class="highlight">' + keyword + '</span>') %}
                        {{ text | safe }}
                    </td>
                    <td>{{ poem.fro }}</td>
                    <td>{{ poem.kind }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% endif %}

        <!-- 分页 -->
        <div class="pagination">
            {% if poems.has_prev %}
            <a href="{{ url_for('index', page=poems.prev_num) }}">上一页</a>
            {% endif %}

            {% for num in poems.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
            {% if num %}
            {% if poems.page == num %}
            <span class="current">{{ num }}</span>
            {% else %}
            <a href="{{ url_for('index', page=num) }}">{{ num }}</a>
            {% endif %}
            {% else %}
            <span class="ellipsis">...</span>
            {% endif %}
            {% endfor %}

            {% if poems.has_next %}
            <a href="{{ url_for('index', page=poems.next_num) }}">下一页</a>
            {% endif %}
        </div>

        {% endblock %}
    </main>
    <!-- end main -->

    <!-- footer -->
    <footer>
        <p>版权所有 © 2023 云锦</p>
    </footer>
    <!-- end footer -->
</body>

</html>